---
title: "Controller"
format: html
---

```{r controller-001}
#| include: false
r = redux::hiredis()
r$FLUSHDB()
options(datatable.prettyprint.char = 10L)
```

A **rush** network consists of thousands of workers started on different machines.
This article explains how to start workers in a rush network.
Rush offers three ways to start workers: local workers with `processx`, remote workers with `mirai` and script workers.

# Local Workers {#sec-local-workers}

We use the random search example from the [Rush article](rush.html) to demonstrate how the controller works.

```{r controller-002}
library(rush)

wl_random_search = function(rush, branin) {
  while(TRUE) {

    xs = list(x1 = runif(1, -5, 10), x2 = runif(1, 0, 15))
    key = rush$push_running_tasks(xss = list(xs))

    ys = list(y = branin(xs$x1, xs$x2))
    rush$push_results(key, yss = list(ys))
  }
}

rush = rsh(
  network = "test-network",
  config = redux::redis_config())
```

